<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="./css/t2.css" />
  </head>
  <body>
    <!-- <section>
      <div class="ap">
        <div class="do a1"><img src="./img/區域特效/楓葉8.png" alt="" /></div>
        <div class="do a2"><img src="./img/區域特效/楓葉3.png" alt="" /></div>
        <div class="do a3"><img src="./img/區域特效/楓葉7.png" alt="" /></div>
        <div class="do a4"><img src="./img/區域特效/楓葉1.png" alt="" /></div>
        <div class="do a5"><img src="./img/區域特效/楓葉2.png" alt="" /></div>
        <div class="do a6"><img src="./img/區域特效/楓葉3.png" alt="" /></div>
        <div class="do a7"><img src="./img/區域特效/楓葉1.png" alt="" /></div>
      </div>
    </section>

    <div class="main">
      <ul>
        <li class="block-1">
          <div class="do a1"><img src="./img/區域特效/楓葉8.png" alt="" /></div>
          <div class="do a2"><img src="./img/區域特效/楓葉3.png" alt="" /></div>
          <div class="do a3"><img src="./img/區域特效/楓葉7.png" alt="" /></div>
          <div class="do a4"><img src="./img/區域特效/楓葉1.png" alt="" /></div>
          <div class="do a5"><img src="./img/區域特效/楓葉2.png" alt="" /></div>
          <div class="do a6"><img src="./img/區域特效/楓葉3.png" alt="" /></div>
          <div class="do a7"><img src="./img/區域特效/楓葉1.png" alt="" /></div>
          <h2>追尋無窮寬廣的</h2>
          <h2 class="block-1-h2">未知世界</h2>
          <a href=""><h1>海拉魯全境</h1></a>
          <p>
            廣大的海拉魯孕育出美麗的<br />
            自然環境與多樣的種族，每<br />
            個地區都有它獨有的特色。
          </p>
        </li>
        <li class="block-2">
          <div class="do a1"><img src="./img/區域特效/楓葉8.png" alt="" /></div>
          <div class="do a2"><img src="./img/區域特效/楓葉3.png" alt="" /></div>
          <div class="do a3"><img src="./img/區域特效/楓葉7.png" alt="" /></div>
          <div class="do a4"><img src="./img/區域特效/楓葉1.png" alt="" /></div>
          <div class="do a5"><img src="./img/區域特效/楓葉2.png" alt="" /></div>
          <div class="do a6"><img src="./img/區域特效/楓葉3.png" alt="" /></div>
          <div class="do a7"><img src="./img/區域特效/楓葉8.png" alt="" /></div>
          <h2>寬闊紅葉與豐富</h2>
          <h2 class="block-2-h2">歷史的高原</h2>
          <a href="explore01.html"><h1>阿卡萊地區</h1></a>
          <p>
            阿卡萊地區位於海拉魯地區的東北部， <br />
            樹木染上紅與黃的景色令人印象深刻。<br />
            除了觀賞紅葉之外，還能親近湖水奔落的瀑布<br />
            、觀賞各式各樣的自然風貌。
          </p>
        </li>
        <li class="block-3">
          <h2>雨量豐沛的幽美</h2>
          <h2 class="block-3-h2">水源之鄉</h2>
          <a href=""><h1>拉聶耳地區</h1></a>
          <p>
            拉聶爾地區位於海拉魯東部， <br />
            豐沛的雨量為當地帶來盎然生機。 <br />
            在這裡可以沿著涼爽的水岸散步，<br />
            或是體驗水上活動，是值得推薦的避暑勝地。
          </p>
        </li>
        <li class="block-4">
          <h2>遊覽無邊無際的</h2>
          <h2 class="block-4-h2">沙海</h2>
          <a href=""><h1>格魯德地區</h1></a>
          <p>
            格魯德地區的沙漠無邊無際。<br />
            白天太陽會不斷照得人熱辣辣的，<br />
            夜晚狂亂的寒風則考驗著旅行者們。
          </p>
        </li>
        <li class="block-5">
          <h2>一遍銀白世界的</h2>
          <h2 class="block-5-h2">山岳地帶</h2>
          <a href=""><h1>海布拉地區</h1></a>
          <p>
            位於海拉魯東北邊的海布拉地區，<br />
            是一個內行人才知道的觀光景點。<br />
            能夠體驗積雪山區特有的壯麗景觀。
          </p>
        </li>
        <li class="block-6">
          <h2>充滿灼熱岩漿的</h2>
          <h2 class="block-6-h2">火山奇景</h2>
          <a href=""><h1>奧爾汀地區</h1></a>
          <p>
            遍布滾燙熔岩的火山「死亡之山」。<br />
            座落在火山周邊一帶的奧爾汀地區，<br />
            因岩漿的熱氣而充斥著高溫。
          </p>
        </li>
      </ul>
    </div> -->
    <!-- 
    <div class="tblock">
      <div class="tdiv">
        <div class="text red">1</div>
        <div class="text blue">2</div>
        <div class="text green">3</div>
        <div class="text yellow">4</div>
      </div>
    </div>

    <div class="btn">
      <button class="tbtn l">&larr;</button>
      <button class="tbtn r">&rarr;</button>
    </div>

    <script>
      const text = document.querySelector(".text");
      const textStyle = getComputedStyle(text);
      console.log(textStyle);
    </script> -->

    <div class="carousel">
      <div class="container">
        <div class="content main">
          <!-- <a  href=""
            ><img src="./icon/angles-leftred-solid-removebg-preview.png" alt=""
          /></a> -->
          <div class="main-title"><h1>角色介紹</h1></div>
          <ul>
            <!-- <li>
              <img class="character-1" src="./img/前端作業/薩爾達.png" alt="" />
            </li>
            <li>
              <img class="character-2" src="./img/前端作業/林克.png" alt="" />
            </li>
            <li>
              <img class="character-3" src="./img/前端作業/加農多夫.png" alt="" />
            </li> -->
            <li class="character-1">
              <a href="character2.html"><p>薩爾達</p></a>
            </li>
            <li class="character-2">
              <a href="character.html"><p>林克</p></a>
            </li>
            <li class="character-3">
              <a href=""><p>加農多夫</p></a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="btnContainer">
      <button class="btn btn-prev">&larr;</button>
      <button class="btn btn-next">&rarr;</button>
    </div>

    <script>
      // 可調整參數
      // 輪播內容物的顯示數量
      const contentToShow = 1;
      // 輪播切換時的速度，單位為ms
      const moveSpeed = 500;

      // 選取會使用的element
      const carousel = document.querySelector(".carousel");
      const container = document.querySelector(".container");
      const allContent = document.querySelectorAll(".content");
      const firstContent = allContent[0];
      const lastContent = allContent[allContent.length - 1];
      const content = document.querySelector(".content");
      const prevBtn = document.querySelector(".btn-prev");
      const nextBtn = document.querySelector(".btn-next");
      const contentComputeStyle = getComputedStyle(content);

      // 取得輪播內容物個數
      const contentAmount = document.querySelectorAll(".content").length;

      let distanceBetweenContent;

      // 輪播容器之位置
      let position = 0;

      // 全域變數，管理輪播是否可以切換
      let disableMove;

      // 設定輪播所需的style，也可以在css中直接新增
      carousel.style.overflow = "hidden";
      carousel.style.position = "relative";
      container.style.display = "flex";
      container.style.position = "absolute";

      const setContentWidth = function () {
        const carouselWidth = carousel.offsetWidth;

        // 可藉由給予輪播內容物margin-right屬性來設定內容物間的間隔
        const gap = parseInt(contentComputeStyle["margin-right"]);

        // 基於內容物的顯示數量，計算各內容物所需的大小
        const contentWidth =
          (carouselWidth - gap * Math.ceil(contentToShow - 1)) / contentToShow;

        allContent.forEach((el) => (el.style.width = `${contentWidth}px`));

        // 設定完內容物寬度後
        // 設定內容物間x軸之差，此為容器移動1單位之距離
        distanceBetweenContent =
          content.nextElementSibling.offsetLeft - content.offsetLeft;
      };
      const setContentHeight = function () {
        // 基於內容物的高度來設定容器高度
        carousel.style.height = contentComputeStyle.height;
      };

      const move = function (step) {
        // 由於不斷切換輪播時會產生動畫不平均的現象，因此設定在動畫完成後，才可以繼續切換輪播
        if (disableMove) return;
        // 更新位置
        position -= step;
        // 移動
        // 設定輪播切換的動畫時間
        container.style.transition = `transform ${moveSpeed}ms`;
        container.style.transform = `translateX(${
          distanceBetweenContent * (position - Math.ceil(contentToShow))
        }px`;

        if (
          position <= -contentAmount ||
          position >= Math.ceil(contentToShow)
        ) {
          position =
            position >= Math.ceil(contentToShow)
              ? -contentAmount + Math.ceil(contentToShow)
              : 0;
          container.addEventListener("transitionend", () => {
            // 取消動畫
            container.style.transition = "transform 0s";
            // 移動
            container.style.transform = `translateX(${
              distanceBetweenContent * (position - Math.ceil(contentToShow))
            }px`;
          });
        }
      };

      const insertClonedSlider = function () {
        // 複製前方再插入後方
        Array.from(allContent)
          .slice(0, Math.ceil(contentToShow))
          .reverse()
          .forEach((el) =>
            lastContent.insertAdjacentElement("afterend", el.cloneNode(true))
          );

        // 複製後方再插入前方
        Array.from(allContent)
          .slice(-Math.ceil(contentToShow))
          .forEach((el) =>
            firstContent.insertAdjacentElement(
              "beforebegin",
              el.cloneNode(true)
            )
          );
      };

      // 動畫開始時，禁止移動，直到動畫結束
      container.addEventListener("transitionstart", () => {
        disableMove = true;
      });
      container.addEventListener("transitionend", () => {
        disableMove = false;
      });

      prevBtn.addEventListener("click", function () {
        move(-1);
      });
      nextBtn.addEventListener("click", function () {
        move(1);
      });

      const init = () => {
        setContentWidth();
        setContentHeight();
        insertClonedSlider();
        // 最初的移動
        container.style.transform = `translateX(${
          -distanceBetweenContent * Math.ceil(contentToShow)
        }px)`;
      };
      init();
    </script>
  </body>
</html>
